<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>청소구역 배정 프로그램</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* Inter 폰트와 Tailwind CSS 기본 설정을 적용합니다. */
        body {
            font-family: 'Inter', sans-serif;
        }
        /* 활성 탭과 비활성 탭의 시각적 구분을 명확하게 합니다. */
        .nav-link.active {
            border-bottom-color: #3b82f6; /* blue-500 */
            color: #3b82f6;
        }
        /* 페이지 전환 시 부드러운 효과를 줍니다. */
        .page {
            display: none;
        }
        .page.active {
            display: block;
        }
    </style>
</head>
<body class="bg-gray-100 flex items-start justify-center min-h-screen p-4">

<div class="w-full max-w-2xl bg-white rounded-xl shadow-lg overflow-hidden">
    <!-- 네비게이션 탭 -->
    <nav class="flex bg-gray-50 border-b border-gray-200">
        <a id="nav-assign" class="nav-link flex-1 py-4 px-2 text-center font-semibold text-gray-600 cursor-pointer border-b-4 border-transparent transition-colors duration-300 active">
            청소구역 배정
        </a>
        <a id="nav-settings" class="nav-link flex-1 py-4 px-2 text-center font-semibold text-gray-600 cursor-pointer border-b-4 border-transparent transition-colors duration-300">
            설정
        </a>
    </nav>

    <!-- 페이지 1: 청소구역 배정 -->
    <div id="page-assign" class="page p-6 md:p-8 active">
        <div class="flex justify-between items-center mb-6">
            <h2 class="text-2xl font-bold text-gray-800">청소구역 배정</h2>
            <button id="random-assign-btn" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-lg shadow-md transition-all duration-300 transform hover:scale-105">
                🎲 랜덤 배정
            </button>
        </div>
        <div id="assignment-container" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
            <!-- 자바스크립트로 동적 생성 -->
        </div>
    </div>

    <!-- 페이지 2: 설정 -->
    <div id="page-settings" class="page p-6 md:p-8">
        <h2 class="text-2xl font-bold text-gray-800 mb-6">설정</h2>
        <div class="space-y-6">
            <div>
                <label for="student-count" class="block text-sm font-medium text-gray-700 mb-1">번호 범위 (총 학생 수)</label>
                <input type="number" id="student-count" min="1" placeholder="예: 30" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
            </div>
            <div>
                <label for="cleaning-areas" class="block text-sm font-medium text-gray-700 mb-1">청소구역 목록 (한 줄에 하나씩 입력)</label>
                <textarea id="cleaning-areas" rows="8" placeholder="예:&#10;교실 앞 복도&#10;교실 뒤 복도&#10;계단&#10;분리수거" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm resize-y"></textarea>
            </div>
        </div>
        <div class="mt-8 flex justify-end items-center">
             <span id="save-feedback" class="text-green-600 font-semibold mr-4"></span>
            <button id="save-settings-btn" class="bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-5 rounded-lg shadow-md transition-all duration-300 transform hover:scale-105">
                💾 저장
            </button>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', () => {
    // DOM 요소 가져오기
    const navAssign = document.getElementById('nav-assign');
    const navSettings = document.getElementById('nav-settings');
    const pageAssign = document.getElementById('page-assign');
    const pageSettings = document.getElementById('page-settings');
    
    const studentCountInput = document.getElementById('student-count');
    const cleaningAreasInput = document.getElementById('cleaning-areas');
    const saveSettingsBtn = document.getElementById('save-settings-btn');
    const saveFeedback = document.getElementById('save-feedback');
    
    const assignmentContainer = document.getElementById('assignment-container');
    const randomAssignBtn = document.getElementById('random-assign-btn');

    // 기본 설정값
    const DEFAULT_STUDENT_COUNT = 30;
    const DEFAULT_AREAS = ['교실 앞 쓸기1','교실 앞 쓸기2', '교실 뒤 쓸기1','교실 뒤 쓸기2', '1분단 쓸기1', '1분단 쓸기2', '2분단 쓸기1', '2분단 쓸기2', '3분단 쓸기1', '3분단 쓸기2', '1분단 책상 줄 맞추기1', '1분단 책상 줄 맞추기2', '2분단 책상 줄 맞추기1', '2분단 책상 줄 맞추기2', '3분단 책상 줄 맞추기1', '3분단 책상 줄 맞추기2', '복도 쓸기1', '복도 쓸기2' , '출석부 관리자', '전선 관리자', '핸드폰 관리자1', '핸드폰 관리자2' , '게시판 관리자', '칠판 관리자', '에너지 지킴이', '공기 지킴이', '환경 지킴이'];

    // 페이지 전환 로직
    function showPage(pageToShow) {
        // 모든 페이지와 네비게이션 링크에서 'active' 클래스 제거
        [pageAssign, pageSettings].forEach(p => p.classList.remove('active'));
        [navAssign, navSettings].forEach(n => n.classList.remove('active'));

        // 선택된 페이지와 네비게이션 링크에 'active' 클래스 추가
        if (pageToShow === 'assign') {
            pageAssign.classList.add('active');
            navAssign.classList.add('active');
            loadAssignments(); // 배정 페이지를 보여줄 때마다 목록 갱신
        } else {
            pageSettings.classList.add('active');
            navSettings.classList.add('active');
        }
    }

    navAssign.addEventListener('click', () => showPage('assign'));
    navSettings.addEventListener('click', () => showPage('settings'));

    // 설정 저장 로직
    saveSettingsBtn.addEventListener('click', () => {
        const studentCount = studentCountInput.value;
        // 공백, 빈 줄을 제거하고 유효한 구역만 저장
        const cleaningAreas = cleaningAreasInput.value.split('\n').map(s => s.trim()).filter(Boolean); 
        
        localStorage.setItem('studentCount', studentCount);
        localStorage.setItem('cleaningAreas', JSON.stringify(cleaningAreas));

        // 저장 완료 피드백
        saveFeedback.textContent = '저장되었습니다!';
        setTimeout(() => saveFeedback.textContent = '', 2000); // 2초 후 메시지 사라짐
    });

    // 설정 불러오기 로직
    function loadSettings() {
        const savedCount = localStorage.getItem('studentCount');
        const savedAreas = localStorage.getItem('cleaningAreas');

        studentCountInput.value = savedCount || DEFAULT_STUDENT_COUNT;
        cleaningAreasInput.value = savedAreas ? JSON.parse(savedAreas).join('\n') : DEFAULT_AREAS.join('\n');
    }
    
    // 배정판 불러오기 로직
    function loadAssignments() {
        assignmentContainer.innerHTML = ''; // 기존 목록 초기화
        const areas = JSON.parse(localStorage.getItem('cleaningAreas') || JSON.stringify(DEFAULT_AREAS));
        
        if (areas.length === 0) {
            assignmentContainer.innerHTML = '<p class="text-gray-500 col-span-full text-center">설정 페이지에서 청소구역을 추가해주세요.</p>';
            return;
        }

        areas.forEach(area => {
            const itemHTML = `
                <div class="bg-gray-50 p-4 rounded-lg flex justify-between items-center border border-gray-200">
                    <span class="font-medium text-gray-700">${area}</span>
                    <input type="number" min="1" class="w-20 p-2 text-center border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-400 focus:outline-none">
                </div>
            `;
            assignmentContainer.insertAdjacentHTML('beforeend', itemHTML);
        });
    }

    // 랜덤 배정 로직
    randomAssignBtn.addEventListener('click', () => {
        const studentCount = parseInt(localStorage.getItem('studentCount') || DEFAULT_STUDENT_COUNT, 10);
        const areas = JSON.parse(localStorage.getItem('cleaningAreas') || JSON.stringify(DEFAULT_AREAS));
        const inputs = assignmentContainer.querySelectorAll('input');

        if (areas.length === 0) {
            alert('먼저 설정 페이지에서 청소구역을 지정해주세요.');
            return;
        }
        
        if (studentCount < areas.length) {
            alert(`학생 수(${studentCount}명)가 청소구역 개수(${areas.length}개)보다 적어 모두 배정할 수 없습니다. 설정을 확인해주세요.`);
            return;
        }

        // 1부터 학생 수까지의 숫자 배열 생성
        const numbers = Array.from({ length: studentCount }, (_, i) => i + 1);

        // 숫자 배열을 무작위로 섞음 (Fisher-Yates Shuffle 알고리즘)
        for (let i = numbers.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [numbers[i], numbers[j]] = [numbers[j], numbers[i]];
        }
        
        // 섞인 번호를 순서대로 input에 할당
        inputs.forEach((input, index) => {
            if(index < numbers.length) {
                input.value = numbers[index];
            }
        });
    });

    // 초기화 함수 실행
    loadSettings();
    showPage('assign'); // 첫 화면은 배정 페이지로
});
</script>

</body>
</html>



